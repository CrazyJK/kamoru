<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
<title>Insert title here</title>
</head>
<script type="text/javascript">
var req = null;

function jsClick(){
/**
 * 1. XMLHttpRequest 객체생성
   2. open()
   3. callback function 생성
   4. send()
 */
 	//ie 7.0over, firefox, opera, safai
	if(window.XMLHttpRequest){
		req = new XMLHttpRequest();
	}else{
		//ie 6.0 under
		if(window.ActiveXObject){
			try{
				//ie 6.0
				req = new ActiveXObject("msxml2.XMLHTTP");
			}catch(e){
				//ie 5.0 under
				req = new ActiveXObject("microsoft.XMLHTTP");
			}
		}	
	}

	if(null == req){
		alert("XMLHttpRequest 객체 생성 오류");
		return;
	}

// http://msdn.microsoft.com/en/library
// MSDN / MSDN library / Web Development / HTML and CSS / HTML and DHTML reference / XMLHttpRequest

	//object.open(sMethod, sUrl [, bAsync] [, sUser] [, sPassword])
	req.open("GET","hello.jsp",true);
	req.onreadystatechange = callback;
	req.send(null);
}

function callback(){
	alert(req.readyState + "/" + req.status);
	if(req.readyState == 4 && req.status == 200){
		alert("성공");
	}else if(req.readyState == 4 && req.status != 200){
		alert(req.status);
	}
}

/**
 * DOM 관리방법
   1. 계층 : childNodes()
   2. id   : document.getElementById()
   3. 배열 : document.all() 비추-브라우저에 따라 달라진다.
 */

</script>
<body>
<span id="output"></span>
<input type="button" value="click" onclick="jsClick()"/>
</body>
</html>