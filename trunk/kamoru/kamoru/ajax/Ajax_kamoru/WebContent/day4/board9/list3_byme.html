<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Insert title here</title>
<script type="text/javascript" src="request.js"></script>
<script type="text/javascript">
var timerid = null;
var ajaxBoard = null;
var isServerRequest = false;
window.onload = function(){
	jsInit();
}

function jsInit(){
  if(null == ajaxBoard){	
	  new ajax.xhr.Request({
		    url : "list_ajax.jsp",
		    load : jsGetData	
			});0
  } else {
    ajaxBoard.sendRequest();
  }
  isServerRequest = true;
	var updateState = document.getElementById("updateState");
	updateState.innerHTML = "<font color=red>Loading...</font>"
  timerid = window.setTimeout("jsInit()", 10000);
}

function jsAbort(){
	if(timerid){
		if(isServerRequest){
			ajaxBoard.abort();
		}
	}
}
function jsRequest(){
	jsInit();
}

function jsGetData(responseText){
	isServerRequest = false;
	var boardList = document.getElementById("boradlist");
	var updateState = document.getElementById("updateState");
	updateState.innerHTML = ""
	var result = eval(responseText);
	var html = '';
	html += '<table border="1">                ';
	html += '  <tr>                            ';
	html += '    <th width="10%">번호</th>     ';
	html += '    <th >제목</th>                ';
	html += '    <th width="10%">작성자</th>   ';
	html += '    <th width="30%">작성일시</th> ';
	html += '  </tr>                           ';
	for(var i=0; i<result.length; i++){
		html += '  <tr>                                 ';
		html += '    <td>' + result[i].board_id + '</td>';
		html += '    <td>' + result[i].title    + '</td>';
		html += '    <td>' + result[i].writer   + '</td>';
		html += '    <td>' + result[i].makedate + '</td>';
		html += '  </tr>                                ';
	}
	html += '</table>                          ';
	html += 'Last Updated ' + new Date();
	boardList.innerHTML = html;

//	var htmlCode = document.getElementById("htmlCode");
//	htmlCode.value = document.documentElement.innerHTML;
}
</script>
</head>
<body>
<div id="boradlist"></div>
<a href="javascript:void(0)" onclick="jsAbort()">취소</a>
<a href="javascript:void(0)" onclick="jsRequest()">요청</a>
<a href="insertForm.jsp">등록</a>
<a href="delete.jsp">삭제</a>
<div id="updateState"></div>
</body>
</html>