<HTML>
<HEAD>
<TITLE> XML 객체를 문자열로 변화</TITLE>

<SCRIPT LANGUAGE="JavaScript">

function createXMLDocFromString(str) {
  var xmlDoc = null;

  try {
    if (window.ActiveXObject) {
      //MS XML Document 객체 생성 가능 
      xmlDoc = new ActiveXObject("MSXML.DOMDocument");
      
      // 문자열로 XML 문서를 작성한다.
      xmlDoc.loadXML(str);
      
      //IE에서 오류 처리 하는 방법 
      if (xmlDoc.parseError.errorCode != 0) {
        var msg = "오류가 발생했습니다.\n";
        msg += "오류 코드 : " + xmlDoc.parseError.errorCode + "\n" ;
        msg += "오류 원인: " + xmlDoc.parseError.reason;
        alert(msg);
        return null;
      }
    } else {
      //파이어 폭스에서 XML Parser 객체 생성
      var parser = new DOMParser();
      xmlDoc = parser.parseFromString(str, "text/xml");

      //파이어 폭스에서 오류 처리하는 방법
      if (xmlDoc.documentElement.nodeName == "parsererror") {
        var msg = "오류가 발생했습니다.\n";
        msg += "오류 원인: " + xmlDoc.documentElement.childNodes[0].nodeValue;
        alert(msg);
        return null;
      }
    }
  } catch (e) {
    alert(e);
  }
  
  return xmlDoc;
} 

function toString(xmlDoc) {
  //MS XML document일 경우 xml Document로 부터 문자열을 얻는다.
  if (xmlDoc.xml) {                                            
    return xmlDoc.xml;                                         
  } else {                                                     
    //파이어 폭스 일 경우                                      
    var serial = new XMLSerializer();                          
    return serial.serializeToString(xmlDoc);                   
  }                                                            
  return "";                                                   
}

function loadBooks() {
    var xmlContents = document.getElementById("xmlContents");    
    var str = "";
    
    //문자열로 구성된 XML 문서 
    str += "<books>\n";
    str += "    <book>\n";
    str += "        <isbn>12-1234-123-1</isbn>\n";
    str += "        <title>AJAX 인 액션 </title>\n";
    str += "        <author>데이브 크레인, 에릭 파스칼렐로</author>\n";
    str += "    </book>\n";
    str += "    <book>\n";
    str += "        <isbn>12-1234-123-2</isbn>\n";
    str += "        <title>홍길동의 AJAX Programming </title>\n";
    str += "        <author>홍길동</author>\n";
    str += "    </book>\n";
    str += "    <book>\n";
    str += "        <isbn>12-1234-123-3</isbn>\n";
    str += "        <title>한글판 Professional Ajax</title>\n";
    str += "        <author>Nicholas C. Zakas , Jeremy McPeak , Joe Fawcett</author>\n";
    str += "    </book>\n";
    str += "    <book>\n";
    str += "        <isbn>12-1234-123-4</isbn>\n";
    str += "        <title>타짜</title>\n";
    str += "        <author>허영만</author>\n";
    str += "    </book>\n";
    str += "    <book>\n";
    str += "        <isbn>12-1234-123-5</isbn>\n";
    str += "        <title>고구려 건국</title>\n";
    str += "        <author>주몽</author>\n";
    str += "    </book>\n";
    str += "    <book>\n";
    str += "        <isbn>12-1234-123-6</isbn>\n";
    str += "        <title>정조대왕</title>\n";
    str += "        <author>이산</author>\n";
    str += "    </book>\n";
    str += "</books>\n";
    
  xmlDoc = createXMLDocFromString(str);
  if (xmlDoc == null) return;
  
  xmlContents.value = toString(xmlDoc);

}

</SCRIPT>

</HEAD>

<BODY onload="loadBooks();">

<h3>XML 객체를 문자열로 변화</h3>
<hr>
XML 객체를 문자열로 변화<br/>
<textarea id='xmlContents' name='xmlContents' readonly="readonly" rows="20" cols="80" wrap="off"></textarea>

</BODY>
</HTML>
