<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
	<title>책정보 보기</title>
	<script type="text/javascript" src="ajax.js"></script>
	<script type="text/javascript">
	
  function loadBooks() {
		new  ajax.xhr.Request("books.jsp", null, loadedBooks, "GET");
	}
    
    function getNodeValue(node) {
      var childList = node.childNodes;
      var str = "";
      for (var i=0;i<childList.length;i++) {
        //Text 문자열을 얻는다.
        if (childList[i].nodeType == 1) {
          str += childList[i].nodeName;
        } else if (childList[i].nodeType == 3) {
          str += childList[i].nodeValue;
        }
      }
      return str;
    }
    
	function loadedBooks(reg) {
		if (reg.readyState == 4) {
			if (reg.status == 200) {
				var xmlDoc = reg.responseXML;
				var bookList = xmlDoc.getElementsByTagName("book");
				var message = "책 개수 : "+bookList.length+"권\n";
        var book = null;
        var isbnValue = null;
        var titleValue = null;
        var authorValue = null;
                
				for (var i = 0 ; i < bookList.length ; i++) {
          //book = bookList.item(i);
          book = bookList[i];
          
          isbnValue = getNodeValue(book.getElementsByTagName("isbn")[0]);
          titleValue = getNodeValue(book.getElementsByTagName("title")[0]);
					authorValue = getNodeValue(book.getElementsByTagName("author")[0]);

					message += isbnValue + " " + titleValue + "(" + authorValue + ")\n";
				}
				alert(message);
			}
		}
	}
	
	window.onload = function() {
		loadBooks();
	}
	</script>
</head>
<body>
책 정보를 alert 으로 출력
</body>
</html>