<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Insert title here</title>
<script type="text/javascript" src="request.js"></script>

<script type="text/javascript">
/*
 * 서버의 처리 시간 지연으로 클라이언트에서 자동 취소
 */
window.onload = function() {
	boardReload();
}

function boardReload() {
	g_process = false;
	setTimeout("boardReload2()", 0);
	setTimeout("timeoutCheck()", 5000);
}

var g_boardReq = null;
var g_process = false;

function timeoutCheck() {
	if (g_process == false) {
		alert("해당 작업은 서버의 지연으로 취소되었습니다");
		g_boardReq.req.abort();
	}
}

function boardReload2() {
	if (null == g_boardReq) { 
		g_boardReq = new ajax.xhr.Request({
			url : "list4.jsp" ,
			method : "GET" ,
			param : null,
			load : function(req) {

				g_process = true;
								
				var html = "";
				var arr = eval(req.responseText);
				
				html += '<table border="1">'
				html += '<tr>'
				html += '  <th width="10%">번호</th>'
				html += '  <th >제목</th>'
				html += '  <th width="10%">작성자</th>'
				html += '  <th width="30%">작성일시</th>'
				html += '</tr>'
				for (var i=0;i<arr.length;i++) {
					html += '<tr>'
					html += '  <td>' + arr[i].board_id + '</td>'
					html += '  <td>' + arr[i].title + '</td>'
					html += '  <td>' + arr[i].writer + '</td>'
					html += '  <td>' + arr[i].makedate + '</td>'
					html += '</tr>'
				}
						
				html += '</table>'
				
				var listPanel = document.getElementById("listPanel");
				
				listPanel.innerHTML = html;

			}
		});
	} else {
		g_boardReq.send();
	}

	setTimeout("boardReload()", 5000);
}
</script>
</head>
<body>
<!--  자바스크립트를 이용하여 문서 생성  -->
<div id="listPanel"></div>

<a href="insertForm.jsp">등록</a>
<a href="delete.jsp">삭제</a>

</body>
</html>