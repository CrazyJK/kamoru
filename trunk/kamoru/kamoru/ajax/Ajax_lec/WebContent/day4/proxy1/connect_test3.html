<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
  <title>외부 서버 연결 테스트 </title>
  <style type="text/css">
    ul {
      margin: 0px 0px;
      border-style: solid;
      border-width: 1px;
      padding: 1px 1px;
    }
    li {
      list-style-type: none;
    }
  </style>
  <script type="text/javascript" src="js/ajax.js"></script>
  <script type="text/javascript">
  var xmlDoc = null;
  var xslDoc = null;
  
  window.onload = function() {
	new  ajax.xhr.Request({
                          url              : "proxy_post.jsp", 
                          params           : null, 
                          callbackFunction : loadComplateXML,
                          method           : "GET" 
                          });
  new  ajax.xhr.Request({
                          url              : "proxy_get.xsl", 
                          params           : null, 
                          callbackFunction : loadComplateXSL,
                          method           : "GET" 
                          });
  }
  
  function loadComplateXML(reg) {
    if (reg.readyState == 4) {
      if (reg.status == 200) {
        xmlDoc = reg.responseXML;
        doXSLT();
      }
    }
  }

  function loadComplateXSL(reg) {
    if (reg.readyState == 4) {
      if (reg.status == 200) {
        xslDoc = reg.responseXML;
        doXSLT();
      }
    }
  }

  function doXSLT() {
    if (xmlDoc == null || xslDoc == null) return;
    
    var result = document.getElementById("result");
    
    if (window.ActiveXObject) {
      result.innerHTML = xmlDoc.transformNode(xslDoc);
    } else {
      var xsltProc = new XSLTProcessor();
      xsltProc.importStylesheet(xslDoc);
      var fragment = xsltProc.transformToFragment(xmlDoc, document);
      result.innerHTML = "";
      result.appendChild(fragment);
    }
  } 

  </script>
</head>
<body>
<H3>외부 서버 연결 테스트 </H3>
<hr>
<div id="result"></div>
</body>
</html>