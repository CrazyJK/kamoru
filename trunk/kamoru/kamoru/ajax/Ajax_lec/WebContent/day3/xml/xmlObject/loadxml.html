<HTML>
<HEAD>
<TITLE> XML 객체를 생서하고 XML 문서 읽기 </TITLE>

<style>
 body { font-size:9pt; }
 textarea {background-color: #C0C0F0;}
</style>

<SCRIPT LANGUAGE="JavaScript">
<!--

function createXMLDocFromURL(url) {
  var xmlDoc = null;
  
  try {
    if (window.ActiveXObject != null) {
      //MS XML Document 객체 생성 가능 
      xmlDoc = new ActiveXObject("MSXML.DOMDocument");
      //동기 모드로 XML 문서 읽기 설정
      xmlDoc.async = false;
      
      // xml 을 파일로 불러올때.
      xmlDoc.load("books.xml");
    } else {
      //파이어 폭스에서 XML Document 객체 생성
      var xmlDoc = document.implementation.createDocument("", "", null);
      //동기 모드로 XML 문서 읽기 설정
      xmlDoc.async = false;
      
      // xml 을 파일로 불러올때.
      xmlDoc.load("books.xml");
    }
  } catch (e) {
    alert(e);
    return null;
  }
    
  return xmlDoc;
} 

function nodeStr(node, tabs) {

    var msg = "";
    if (tabs == null) {
      tabs = "";
    }
    msg += tabs + "[노드이름 : "    + node.nodeName  + "]"
    msg += tabs + "[노드의 타입 : "  + node.nodeType  + "]"
    msg += tabs + "[노드문자 : "    + node.text      + "]"
    msg += tabs + "[노드의 값 : "    + node.nodeValue + "]\n"
    
    var nodeList = node.childNodes;

    if (nodeList != null ) {
      tabs += "\t";
      for(var i=0;i<nodeList.length;i++) {
          msg += "---------------------------------------------\n";
          msg += nodeStr(nodeList[i], tabs);
      }
    }
    return msg;

}

function loadXML() {
  var xmlContents = document.getElementById("xmlContents");    

  // xml 을 파일로 불러올때.
  xmlDoc = createXMLDocFromURL("books.xml");
  if (xmlDoc == null) return;
  
  //루트 노드를 얻는다.
  var root = xmlDoc.documentElement;
  var msg = "";
  
  msg = "하위 노드의 갯수 : " + root.childNodes.length + "\n";
  msg += nodeStr(root, "");
  
  xmlContents.value = msg;
    
}

//-->
</SCRIPT>

</HEAD>

<BODY onload="loadXML()">
<h3>XML 객체를 생서하고 XML 문서 읽기 </h3>
<hr>
읽어 들인 XML 문서<br/>
<textarea id='xmlContents' name='xmlContents' readonly="readonly" rows="20" cols="80" wrap="off"></textarea>

</BODY>
</HTML>
