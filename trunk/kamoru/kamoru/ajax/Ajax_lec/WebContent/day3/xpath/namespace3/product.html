<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
  <title>ajax.xml.Document 클래스를 이용한 크로스 브라우저 테스트 </title>
  <script type="text/javascript" src="ajax.js"></script>
  <script type="text/javascript">
  var xmlObj = new ajax.xml.Document();
  
  //XML 문서를 읽어 화면에 출력한다.  
  function loadXML() {
	new  ajax.xhr.Request("product.jsp", null, loadProductXML, "GET");
  }
    
  function loadProductXML(reg) {
    if (reg.readyState == 4) {
      if (reg.status == 200) {
        xmlObj.xmlDoc = reg.responseXML;
        doProcess();
      }
    }
  }
  
  function doProcess() {
    if (xmlObj.xmlDoc == null) return;
    
    //XML 객체를 문자열로 출력한다.
    var xmlContents = document.getElementById("xmlContents");    
    
    xmlContents.value = xmlObj.toString();
    
    //nacespace를 설정한다 .
    xmlObj.setNamespace("xmlns:a='http://www.multicampus.or.kr/a' xmlns:b='http://www.multicampus.or.kr/b'");

  }
  
  function nodeOutput(node) {
    var xmlOutput = document.getElementById("xmlOutput");    
    var msg;
    
    msg = "id : " + node.getAttribute("id");
    msg += "\ntitle :" + xmlObj.getNodeValue(node, "name");
    msg += "\nauthor :" + xmlObj.getNodeValue(node, "price");
    
    xmlOutput.value = msg;
  }

  function nodesOutput(nodes) {
    //출력용 textarea 이다.
    var xmlOutput = document.getElementById("xmlOutput");    
    var msg = "";
    var node;
    
    if (nodes.lenght == 0) {
      xmlOutput.value = "자료를 찾을 수 없습니다.";
       return ;
    }
    
    for (var i=0;i<nodes.length;i++) {
        node = nodes[i];
        msg += "\nid : " + node.getAttribute("id");
        msg += "\nname :" + xmlObj.getNodeValue(node, "name");
        msg += "\nprice :" + xmlObj.getNodeValue(node, "price");
        msg += "\n-------------------------";
    }

    xmlOutput.value = msg;
  }

  function locationFilter1() {
    var product = xmlObj.selectSingleNode(".//a:product[1]");
    var xmlOutput = document.getElementById("xmlOutput");    
    
    if (null == product) {
      xmlOutput.value = "product[1]의 노드를 찾을 수 없습니다."
    } else {
      nodeOutput(product);    
    }  
  }

  function locationFilter2() {
    var products = xmlObj.selectNodes(".//b:product[name]");
    var xmlOutput = document.getElementById("xmlOutput");    
    
    if (null == products) {
      xmlOutput.value = "product[1]의 노드를 찾을 수 없습니다."
    } else {
      nodesOutput(products);    
    }
  }

  window.onload = function() {
    loadXML();
  }

  </script>
</head>
<body>
<h3>ajax.xml.Document 클래스를 이용한 크로스 브라우저 테스트 </h3>
<hr>
XML 문서 내용 <br/>
<textarea id='xmlContents' name='xmlContents' readonly="readonly" rows="20" cols="80" wrap="off"></textarea><br/>
결과 화면 <br/>
<textarea id='xmlOutput' name='xmlOutput' readonly="readonly" rows="10" cols="80" wrap="off"></textarea><br/>

<input type="button" value="a:product[1]" onclick="locationFilter1()">
<input type="button" value="b:product[name]" onclick="locationFilter2()">
</body>
</html>