<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
<title>XMLHttpRequest 모듈을 이용한 예제 </title>
<script type="text/javascript" src="httprequest.js"></script>
<script type="text/javascript">
function onClick_send() {
  var name    = document.form1.name;
  var age     = document.form1.age;
  var address = document.form1.address;
  //응답 인자를 JSON 표기법으로 생성 한다.
  //var params  = {name : "홍길동", age : 10, address : "서울특별시 강남구"};
  //응답 인자를 JSON 표기법으로 생성 한다.
  var params  = {name : name.value, age : age.value, address : address.value};

 //웹서버의  sample3.jsp를 호출 할때 요청 인자 전달하고 호출방식은 POST 방식으로 한다. 
 //응답결과는 callback 함수에서 처리한다.
  sendRequest("sample3.jsp", params, callback, "POST");
}

//디버그 메시지 출력하는 함수 
function debugTrace(msg) {
  var debug = document.getElementById("debug");
  
  debug.value = debug.value + msg;
}

function callback() {

  var msg = "";
  
   switch (httpRequest.readyState) {
   case 1:
        msg = "Loading...\n";
        break;
   case 2:
        msg = "Loaded...\n";
        break;
   case 3:
        msg = "Interactive\n";
        break;
   case 4:
        //서버로부터 응답 도착 
        msg = "Complate\n";
        if (httpRequest.status == 200) {
          msg += "웹 서버에서 정상적으로 수행\n";
          msg += "결과 : \n";
          msg += httpRequest.responseText + "\n---------------------------------------------\n";
          
        } else {
          msg = "웹 서버에서 오류 발생\n"
                + "오류 코드 : " + httpRequest.status + "\n"
                + "오류 문자열 : " + httpRequest.statusText + "\n";
        }
        break;
   }
   debugTrace(msg);
}

function clear_onclick() {
  var debug = document.getElementById("debug");
  debug.value="";
}
</script>
</head>
<body>

<h3>XMLHttpRequest 모듈을 이용한 예제  </h3>
<hr>
<form name="form1">
  <textarea rows="15" cols="80" id="debug" name="debug"></textarea>
  <br/>
  이름 : <input type="text" name="name" size=10> <br/>
  나이 : <input type="text" name="age"  size=3 maxlength="3"> <br/>
  주소 : <input type="text" name="address" size=50> <br/>
  <input type="button" value="서버에 자료 전달 " onclick="onClick_send()">
  <input type="button" value="초기화" onclick="clear_onclick()">
</form>
</body>
</html>