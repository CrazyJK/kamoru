<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
<title>클래스로 XMLHttpRequest 모듈만들기 예제 </title>
<script type="text/javascript" src="ajax2.js"></script>
<script type="text/javascript">
function onClick_send() {
  var name    = document.form1.name;
  var age     = document.form1.age;
  var address = document.form1.address;
  //응답 인자를 JSON 표기법으로 생성 한다.
  var params  = {name : name.value, age : age.value, address : address.value};

 //웹서버의  sample3.jsp를 호출 할때 요청 인자 전달하고 호출방식은 POST 방식으로 한다. 
 //응답결과는 callback 함수에서 처리한다.
   new ajax.xhr.Request("sample3.jsp", params, callback1, "POST");
   new ajax.xhr.Request("sample4.jsp", params, callback2, "POST");
}

//디버그 메시지 출력하는 함수 
function debugTrace(msg) {
  var debug = document.getElementById("debug");
  
  debug.value = debug.value + msg;
}

function callback1(req) {

  var msg = "";
  
   switch (req.readyState) {
   case 4:
        //서버로부터 응답 도착 
        if (req.status == 200) {
          msg += "callack1 () 에서 처리된 결과 : \n";
          msg += req.responseText + "\n---------------------------------------------\n";
        }
        break;
   }
   debugTrace(msg);
}

function callback2(req) {

  var msg = "";
  
   switch (req.readyState) {
   case 4:
        //서버로부터 응답 도착 
        if (req.status == 200) {
          msg += "callack2 () 에서 처리된 결과 : \n";
          msg += req.responseText + "\n---------------------------------------------\n";
        }
        break;
   }
   debugTrace(msg);
}

function clear_onclick() {
  var debug = document.getElementById("debug");
  debug.value="";
}
</script>
</head>
<body>

<h3>클래스로 XMLHttpRequest 모듈만들기 예제 </h3>
<hr>
<form name="form1">
  <textarea rows="15" cols="80" id="debug" name="debug"></textarea>
  <br/>
  이름 : <input type="text" name="name" size=10> <br/>
  나이 : <input type="text" name="age"  size=3 maxlength="3"> <br/>
  주소 : <input type="text" name="address" size=50> <br/>
  <input type="button" value="서버에 자료 전달 " onclick="onClick_send()">
  <input type="button" value="초기화" onclick="clear_onclick()">
</form>
</body>
</html>